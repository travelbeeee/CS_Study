## NoSQL

### NoSQL 이란?

**Not Only SQL**의 약자로, 기존 RDBMS 형태의 관계형 DB가 아닌 다른 형태의 모든 데이터 저장 기술을 의미한다. 

**관계형 DB의 한계를 극복하기 위한 새로운 형태로, 수평적 확장성**을 갖고 있다.

문서, 그래프, 키 값 등을 포함해 다양한 데이터 모델을 사용한다. 

NoSQL은 2000년대 말에 스토리지 비용이 크게 하락하면서 등장했다.

스토리지 비용이 하락했기 때문에 데이터 중복 감소를 목적으로 복잡하고 관리가 어려운 데이터 모델을 생성할 필요가 없어졌기 때문이다.

스토리지 비용보다 **개발자들의 생산성에 맞게 최적화** 되었다.

### 종류

NoSQL은 크게 4가지로 나뉘며 데이터 구조에 따라 구분한다. 

#### Key-Value DB

Key-Value의 쌍으로 데이터가 저장되는 유형이다. Amazon의 Dynamo Paper에서 유래됨.

Key를 참조하는 방식으로만 간단하게 검색이 가능하다. 

대량의 데이터를 저장해야 하고, 검색을 위해 복잡한 쿼리가 필요 없는 사례에 적합하다. 

ex) Redis, DynanoDB, Tokyo 등

#### Wide Column DB

Big Table DB라고도 불린다. Google의 BigTable Paper에서 유래됨.

각 Row가 동일한 Column을 가질 필요가 없기 때문에 뛰어난 유연성을 제공한다. 

대량의 데이터를 저장해야 할 때 적합하다.

보통 사물인터넷 데이터와 사용자 프로필 데이터를 저장할 때 사용된다. 

ex) HBase, Cassandra, Hypertable 등

#### KDocument DB

Lotus Notes에서 유래됨.

JSON, XML과 같은 Collection 데이터 모델 구조를 사용한다. 

ex) MongoDB, Cough DB 등

#### Graph DB

Eluer & Graph Theory에서 유래됨.

Node와 Edge에 데이터를 저장한다.

Node : 사람, 장소, 사물 등

Edge : Node간의 관계에 대한 정보 

SNS, 사기 탐지 등과 같은 패턴을 찾기 위해 관계를 상세히 검토해야 하는 사례에 적합하다. 

ex) Neo4J,  JanusGraph 등 

### SQL과의 차이점

1. NoSQL은 데이터 간의 **관계를 정의하지 않는다**. 

   데이터 테이블은 그냥 하나의 테이블이며 테이블 간 관계를 정의하지 않는다.

   일반적으로 Join도 불가능하다. 

   ** **NoSQL에는 관계형 데이터를 저장할 수 없을까?**

   NoSQL은 관계형 데이터를 저장하지 않는다고 오해할 수 있지만, NoSQL에서도 관계형 데이터를 저장할 수 있다. 

   다만 이는 SQL과는 다른 방식으로 이루어지며, 관련된 데이터들을 테이블간에 분할 할 필요 없이 단일 데이터 구조 내에 중첩시킬 수 있다. 

2. RDBMS에 비해 **대용량의 데이터를 저장**할 수 있다. 

   RDBMS의 복잡도와 용량의 한계를 극복하기 위해 등장했기 때문에, PB급의 대용량 데이터를 저장할 수 있다.

3. **분산형 구조**이다.

   RDBMS처럼 하나의 고성능 머신에 데이터를 저장하는 것이 아니라, 일반적인 서버 수십 대를 연결하여 저장 및 처리하는 구조를 가진다.

   즉, 분산형 구조를 통해 데이터를 여러 대의 서버에 분산 저장하기 때문에 특정 서버에 장애가 발생했을 때도 데이터 유실이나 서비스 중지가 없는 구조이다. 

4. **고정되지 않은 테이블 스키마**를 가진다.

   RDBMS와 다르게 테이블 스키마가 유동적이다. 

   데이터 저장시에 데이터별로 다른 컬럼과 다른 데이터 타입을 갖는 것이 허용된다. 

   ** 스키마 ? : DB의 구조와 제약조건에 관한 전반적인 명세를 기술한 메타데이터의 집합

   따라서, **개발 중간에 데이터 설계가 변경되어도 빠르게 수정 및 적용이 가능**하다. 

   ** SQL만을 썼을 때는..

   >과거에는 폭포수 모델로 개발이 진행되었기에 개발 전에 상세한 계획이 수립되었다. 따라서 개발자들은 저장이 필요한 모든 데이터를 신중하게 고려하여 복잡한 ERD를 만들었다. 
   >
   >하지만 개발 중간에 요구사항이 바뀔 경우, 대처에 애를 먹었다. 그 결과 예산이 초과되고 마감기한을 넘겨 사용자의 요구를 충족하지 못하는 일이 많았다.



![image-20211011184711850](..\images\NoSQL_1.png)

### NoSQL의 장점

1. 유연성

   일반적으로 유연한 스키마를 제공한다.

   따라서 비정형 데이터에 대해 이상적이다.

2. 확장성

   고가의 강력한 서버 대신에 분산형 하드웨어 클러스터를 이용해 확장하도록 설계되었다.

   손쉽게 확장이 가능하다. 

3. 고성능

   특정 데이터 모델(문서, 그래프 등) 및 액세스 패턴에 최적화되어 

   RDBMS를 통해 유사한 기능을 사용하려할 때 보다 뛰어난 성능을 보여준다. 

4. 고기능성

   각 데이터 모델에 맞추어 구축된 뛰어난 기능의 API와 데이터 유형을 제공한다.

### 언제 NoSQL을 사용해야 할까?

- 데이터의 모양과 크기가 모두 달라서 미리 스키마를 정의하는 것이 불가능 할 때

- 개발 중간에 변화하는 요구사항에 대해 DB를 빠르게 수정해야 할 필요가 있을 때

- 빠른 속도로 개발하고 싶을 때

- 빅 데이터를 처리해야 할 필요가 있을 때

- 대량의 트래픽을 처리해야 할 필요가 있을 때

  >  NoSQL은 확장에 용이하기 때문이다. 



** 그렇다고 NoSQL이 항상 좋다고 할 수는 없다.

금전 처리와 같은 데이터 무결성이 중요한 경우는 SQL을 쓰는 것이 좋다.

명확하게 정의된 스키마로 인해 데이터 무결성를 보장할 수 있고,

중복되는 데이터를 최소화 할 수 있다.



### 추가 ) NoSQL에서의 Transaction 

NoSQL이 등장한 이유가 빅데이터에 대해서 데이터를 빠르게 저장, 조회 처리하는 것이 목적이라 데이터 정합성에 대해서 크게 신경쓰지않고 데이터 정합성이 낮다. 

하지만 트랜잭션을 이용한다는 것은 SQL처럼 데이터 정합성에 대해서 신경쓴다는 뜻인데 그러면 NoSQL의 장점이 사라질 수 있다.

그렇다면 트랜잭션이 필요한 모든 상황에서 SQL을 써야할까?

MongoDB와 같은 일부의 NoSQL에서 공식적으로 transaction을 지원하기 시작했다. 이는 NoSQL에서도 transaction 처리가 필요하다는 경우를 인정하고 있다는게 아닐까?

(미완성답변)
