# MSA (MicroService Architecture)

### MSA란?

하나의 큰 어플리케이션을 여러 개의 작은 어플리케이션으로 쪼개어 변경과 조합이 가능하도록 만든 아키텍쳐이다.

MicroService 는작고 독립적으로 배포 가능한, 각각의 기능을 수행하는 서비스로 구성된 프레임워크를 말한다.

- 각각의 서비스는 크기가 작을 뿐, 서비스 자체는 하나의 모놀리틱 아키텍쳐와 유사한 구조를 가진다.
- 각각의 서비스는 독립적으로 배포가 가능해야한다.
- 각각의 서비스는 다른 서비스에 대한 의존성이 최소화 되어야한다.
- 각 서비스는 개별 프로세스로 구동 되며, REST와 같은 가벼운 방식으로 통신되어야 한다.

#### 등장 배경

SW개발 시 선택 가능한 아키텍쳐

1. Monolithic Architecture
2. SOA (Service Oriented Architecture)
3. MSA

Monolithic Architecture는 SW의 모든 구성요소가 한 프로젝트에 통합되어 있는 형태이다. 

하지만 일정 규모 이상의 서비스, 혹은 수 백명의 개발자가 투입되는 프로젝트에서 Monolithic Architecture는 한계를 보인다. 

- 프로젝트가 커지면 커질수록, 영향도 파악 및 전체 시스템 구조의 파악에 어려움이 있다.
- 빌드 시간 및 테스트시간, 그리고 배포시간이 기하급수적으로 늘어나게 된다.
- 서비스를 부분적으로 scale-out하기가 힘들다.
- 부분의 장애가 전체 서비스의 장애로 이어지는 경우가 발생한다.

따라서, MSA는 비즈니스 민첩성을 위해 고안되었다. 

### 장점

1. 독립적으로 배포 가능

   > 요구사항을 신속하게 반영하여 빠르게 배포할 수 있다.

2. 클라우드 사용에 적합한 아키텍쳐이다.

3. 장애가 전체 서비스로 확장될 가능성이 적다. 

4. 서비스별 기술의 도입 및 확장이 자유롭다.

### 단점

Monolithic Architecture은 단순한 아키텍쳐인데, MSA는 보다 복잡하다. 

따라서 전체 서비스가 커짐에 따라 이 복잡도가 기하급수적으로 늘어날 수 있다. 

1. 서비스가 커질수록 서비스간 통신 비용이나 통신방식에 따른 Latency가 늘어나게 된다. 
2. 서비스가 분리되어 있기 때문에, 테스트와 트랜잭션의 복잡도가 증가하고 더 많은 자원을 필요로 한다.
3. 데이터가 여러 서비스에 걸쳐 분산되기 때문에 한 번에 조회하기 어렵고 데이터 정합성을 관리하기가 어렵다.

### MSA에서 각 서비스간 통신 방식에 무엇이 있을까?

<img src="D:\project\CS_Study\Bada\images\MSA_1.png" alt="image-20211015170647147" style="zoom:50%;" />

1. 요청/응답 

   > 요청 후 응답이 올 때 까지 기다린다.

2. 알림

   > 요청을 보내기만한다. (푸시 알림)

3. 요청/비동기 응답

   > 요청을 보내면 비동기로 응답이 온다.

4. 발행/구독

   > 등록된 서비스들에게 요청을 보낸다. 요청을 받은 서비스들은 각자 로직을 처리한다. 

5. 발행/비동기 응답

   > 4번과 같지만 비동기 형태로 응답을 보낸다. 



### 추가) MSA는 무조건 좋을까?

읽어보면 좋을 글 : https://www.samsungsds.com/kr/insights/msa.html

모놀리식으로 관리하기에 특별히 복잡한 시스템을 운영할 상황이 아니면 마이크로서비스는 고려할 필요조차 없다.

