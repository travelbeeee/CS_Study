### CPU 스케줄러

프로세스의 생명 주기

<img src="https://t1.daumcdn.net/cfile/tistory/990DB03F5C7AC10303" alt="img" style="zoom: 50%;" />

#### CPU 스케줄러란?

여러 프로세스들이 CPU를 교환하며 보다 생산적으로 동작하기 위해 사용한다. 

다음에 실행 될 프로세스를 정하고, 프로세스들을 실행 가능한 상태로 만든다. 

#### 목적

- 일반적인 시스템

  각 프로세스들이 오랫동안 CPU할당을 받지 못하는 기아 상태를 방지하기 위해 사용한다. 

  각 프로세스들이 공평하게 CPU를 이용할 수 있도록 한다. 

  CPU가 쉬는 시간이 없도록 한다. 

- 일괄처리 시스템 (Batch System)

  시간당 최대의 작업량을 내도록 한다.

  프로세스 생성~소멸 까지의 시간을 최소화한다.

  CPU가 쉬는 시간이 없도록 한다. 

- 대화형 시스템 (Interactive System)

  요청에 대해 응답시간을 최소화한다. 

#### 종류

##### 비선점 스케줄링

프로세스가 한 번에 실행될 수 있는 시간에 제한이 없다. CPU를 사용중인 프로세스가 자율적으로 반납할 때 까지 기다린다. 

따라서 자율적으로 CPU를 반납하는 시점에 스케줄링을 한다. 

- **FCFS (First Come First Served)**
  - 먼저 CPU 요청한 프로세스를 먼저 처리한다.
  - burst time이 긴 프로세스가 먼저 요청할 경우, 평균 대기시간이 길어진다.
- **SJF (Shortest Job First)**
  - 평균 waiting time을 최소화하기 위해 사용한다. 
  - burst time이 짧은 프로세스부터 CPU에 할당한다. 
  - burst time이 긴 프로세스는 오래 기다려야 하므로, 기아상태가 될 수 있다. 

##### 선점 스케줄링 

보다 높은 우선순위를 가진 프로세스가 CPU를 선점하는 방식이다.

프로세스가 CPU를 할당받아 실행중이더라도 운영체제가 강제로 빼앗을 수 있다.

- **SRTF(Shortest Remaining Time First)**

  - 최단 잔여시간을 가진 프로세스를 우선으로 스케줄링한다. 
  - 진행중인 프로세스가 있어도, 최단 잔여시간을 가진 프로세스를 위해 진행중인 프로세스를 sleep시키고 짧은 프로세스를 먼저 할당한다. 
  - 선점형 SJF 스케줄링 이라고 불린다. 

- **RR(Round Robin)**

  - Time Sharing System을 위해 설계된 스케줄링 방식이다. 
  - 모든 프로세스가 같은 우선순위를 가지고 time slice를 기반으로 스케줄링한다. 
  - 한 번 실행된 프로세스는 스케줄링 큐의 끝으로 보낸다. 
  - Time slice가 너무 크면 FCFS와 다를 바 없고, 너무 작으면 불필요한 Context Switch가 많이 일어난다. 

- **Priority Scheduling (우선 순위 스케줄링)**

  - 우선순위가 높은 프로세스를 먼저 할당하는 스케줄링 방식이다. 
  - 우선순위는 시간제한, 프로세스의 중요성, 메모리 요구량 등에 따라 달라질 수 있다.
  - 우선순위가 같을경우 FCFS와 다를바 없다. 
  - 선점/비선점 방식에서 모두 이용 가능하다. 
  - Aging 기법 
    - 우선순위가 낮은 프로세스가 기아상태가 되는 것을 방지하기 위해 존재한다.
    - waiting time에 따라서, 일정 시간이 지나면 우선순위를 한 단계 높여주는 방식이다. 

- MLQ (Multi Level Queue)

  - 고정된 우선순위 + RR
  - 프로세스들을 유형에 따라 다른 우선순위를 부여해서, 우선순위 별로 각기 다른 준비 큐에 넣는다. 
  - 각 큐는 절대적인 우선순위를 가진다. 

- MLFQ (Multi Level Feedback Queue)

  - MLQ에서 우선순위가 낮은 큐에 있는 프로세스들이 기아상태가 되는 것을 방지하기 위한 방식이다. 
  - 우선순위가 높은 프로세스에게는 불이익을, 우선순위가 낮은 프로세스에게는 이익을 제공한다. 

  - 규칙
    1. 우선 순위가 높은 큐에 존재하는 프로세스들이 먼저 실행됩니다.
    2. 작업들이 같은 우선 순위를 가진다면 RR을 사용하여 실행합니다.
    3. 작업이 시스템에 진입하면, 가장 높은 우선순위 즉 맨 위의 큐에 놓여진다.
    4. 주어진 단계에서 시간 할당량을 소진하면 ( CPU를 몇 번 양도하던 상관없이 ), 우선 순위는 낮아진다.
    5. 일정 기간 S가 지나면, 시스템의 모든 작업을 다시 최상위 큐로 이동시킨다.